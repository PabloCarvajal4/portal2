<body>
    <div>
    <ul class="menu" *ngIf="documentoSubido"><br><br>
        <li class="centrar"><img class="perfil" [src]="documentoSubido" onerror="this.src='assets\\Design\\usuario-3.png'" alt="" width="128" height="128"></li>
        <li><h5 class="nombre">
            <div *ngIf="colaboradorSeleccionado">
                {{ colaboradorSeleccionado.nombre }}
              </div>           
            </h5></li>
        <li><h5 class="subtitulo">{{colaboradorSeleccionado.departamento}}<br>{{colaboradorSeleccionado.descriP_CENTRO_COSTO}}</h5></li>
<div *ngIf="!colaboradorSeleccionado">
                <p>Colaborador no encontrado.</p>
              </div><br>
              <li class="menu" *ngIf="!depto">
                <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/home', colaboradorSeleccionado.nO_EMPLE]" *ngIf="!esAdmin"> <img class="icon" src="assets\Design\work-from-home.png" >&nbsp;Página Principal</a></h6>
            </li>
            <li class="menu"  *ngIf="!depto">
                <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/home-admin', colaboradorSeleccionado.nO_EMPLE]" *ngIf="esAdmin"><img class="icon" src="assets\Design\work-from-home.png">&nbsp;Página Principal</a></h6>
            </li>
            <li class="menu">
                <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/home-ddhh', colaboradorSeleccionado.nO_EMPLE]" *ngIf="depto"> <img class="icon" src="assets\Design\work-from-home.png" >&nbsp;Página Principal</a></h6>
            </li>
            <li class="menu">
                <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/comprobante-pago', colaboradorSeleccionado.nO_EMPLE]"> <img  class="icon" src="assets\Design\comprobacion.png">&nbsp;Comprobante de Pago</a></h6>
            </li>
            <li class="menu nav-item my-1 disabled">
                <a href="#consultas" data-bs-toggle="collapse" class="nav-link">
                  <h6 class="menu"><a class="nav-link active menu" aria-current="page"> <img class="icon" src="assets\Design\buscar.png">&nbsp;Consultas &nbsp;<img height="15px" width="15px" class="margen" src="assets\Design\flecha-hacia-abajo.png"></a></h6>
                </a>
                  <ul class="nav collapse ms-4" id="consultas" data-bs-parent="#menu">
                    <li class="menu nav-item">
                      <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/consulta-solicitudes', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Consulta de Solicitudes</a></h6>
                  </li>
                    <li class="menu nav-item">
                      <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/consulta-vacaciones', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" class="margen" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Consulta de Vacaciones</a></h6>
                  </li>
                  </ul>
              </li>
              <li class="menu nav-item my-1 disabled">
                <a href="#solicitudes" data-bs-toggle="collapse" class="nav-link">
                  <h6 class="menu"><a class="nav-link active menu" aria-current="page"> <img class="icon" src="assets\Design\aprobacion.png">&nbsp;Solicitudes &nbsp;<img height="15px" width="15px" class="margen" src="assets\Design\flecha-hacia-abajo.png"></a></h6>
                </a>
                  <ul class="nav collapse ms-4" id="solicitudes" data-bs-parent="#menu">
                  <li class="menu nav-item">
                    <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/solicitud-permisos', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" class="margen" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Solicitud de Permisos</a></h6>
                </li>
                <li class="menu nav-item">
                  <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/solicitud-vacaciones', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" class="margen" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Solicitud de Vacaciones</a></h6>
              </li>
              <li class="menu nav-item" *ngIf="depto">
                <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/solicitudes', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" class="margen" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Solicitudes Resueltas</a></h6>
            </li>
                  </ul>
              </li>
            <li class="menu" *ngIf="!depto">
                <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/incapacidades', colaboradorSeleccionado.nO_EMPLE]"> <img class="icon" src="assets\Design\resfriado.png">&nbsp;Incapacidades</a></h6>
            </li>
            <li class="menu nav-item my-1 disabled" *ngIf="depto">
              <a href="#incapacidades" data-bs-toggle="collapse" class="nav-link">
                <h6 class="menu"><a class="nav-link active menu" aria-current="page"> <img class="icon" src="assets\Design\buscar.png">&nbsp;Incapacidades &nbsp;<img height="15px" width="15px" class="margen" src="assets\Design\flecha-hacia-abajo.png"></a></h6>
              </a>
                <ul class="nav collapse ms-4" id="incapacidades" data-bs-parent="#menu">
                  <li class="menu nav-item">
                    <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/incapacidades', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Registrar Incapacidad</a></h6>
                </li>
                  <li class="menu nav-item">
                    <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/incapacidades-registradas', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" class="margen" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Ver Incapacidades Registradas</a></h6>
                </li>
                </ul>
            </li>
            <li class="menu" *ngIf="!depto">
                <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/constancias', colaboradorSeleccionado.nO_EMPLE]"> <img class="icon" src="assets\Design\papel.png">&nbsp;Constancias</a></h6>
            </li>
            <li class="menu nav-item my-1 disabled" *ngIf="depto">
              <a href="#constancias" data-bs-toggle="collapse" class="nav-link">
                <h6 class="menu"><a class="nav-link active menu" aria-current="page"> <img class="icon" src="assets\Design\papel.png">&nbsp;Constancias &nbsp;<img height="15px" width="15px" class="margen" src="assets\Design\flecha-hacia-abajo.png"></a></h6>
              </a>
                <ul class="nav collapse ms-4" id="constancias" data-bs-parent="#menu">
                  <li class="menu nav-item">
                    <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/constancias', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Generar Constancia</a></h6>
                </li>
                  <li class="menu nav-item">
                    <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/constancias-generadas', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" class="margen" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Constancias Generadas</a></h6>
                </li>
                </ul>
            </li>
            <li class="menu" *ngIf="esAdmin && depto">
              <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/aprobacion-solicitudes', colaboradorSeleccionado.nO_EMPLE]"> <img class="icon" src="assets\Design\cheque.png">&nbsp;Aprobación de Solicitudes</a></h6>
          </li>
          <li class="menu" *ngIf="depto && !esAdmin">
            <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/aprobacion-solicitudes', colaboradorSeleccionado.nO_EMPLE]"> <img class="icon" src="assets\Design\cheque.png">&nbsp;Aprobación de Solicitudes</a></h6>
        </li>
        <li class="menu" *ngIf="!depto && esAdmin">
          <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/aprobacion-solicitudes', colaboradorSeleccionado.nO_EMPLE]"> <img class="icon" src="assets\Design\cheque.png">&nbsp;Aprobación de Solicitudes</a></h6>
      </li>
            <li class="menu" *ngIf="!depto">
                <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/denuncia', colaboradorSeleccionado.nO_EMPLE]"> <img class="icon" src="assets\Design\denunciante.png">&nbsp;Denuncia Codigo de Ética o Acoso</a></h6>
            </li>
            <li class="menu nav-item my-1 disabled" *ngIf="depto">
              <a href="#denuncias" data-bs-toggle="collapse" class="nav-link">
                <h6 class="menu"><a class="nav-link active menu" aria-current="page"> <img class="icon" src="assets\Design\buscar.png">&nbsp;Denuncia Código de Ética o Acoso &nbsp;<img height="15px" width="15px" class="margen" src="assets\Design\flecha-hacia-abajo.png"></a></h6>
              </a>
                <ul class="nav collapse ms-4" id="denuncias" data-bs-parent="#menu">
                  <li class="menu nav-item">
                    <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/denuncia', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Registrar Denuncia</a></h6>
                </li>
                  <li class="menu nav-item">
                    <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/denuncias-registradas', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" class="margen" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Ver Denuncias Registradas</a></h6>
                </li>
                </ul>
            </li>
            <li class="menu nav-item my-1 disabled" *ngIf="depto">
              <a href="#sugerencias" data-bs-toggle="collapse" class="nav-link">
                <h6 class="menu"><a class="nav-link active menu" aria-current="page"> <img class="icon" src="assets\Design\buzon.png">&nbsp;Buzón de Sugerencias &nbsp;<img height="15px" width="15px" class="margen" src="assets\Design\flecha-hacia-abajo.png"></a></h6>
              </a>
                <ul class="nav collapse ms-4" id="sugerencias" data-bs-parent="#menu">
                  <li class="menu nav-item">
                    <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/buzon-sugerencia', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Registrar Sugerencia</a></h6>
                </li>
                  <li class="menu nav-item">
                    <h6 class="margen"><a class="nav-link active menu" aria-current="page" [routerLink]="['/sugerencias-recibidas', colaboradorSeleccionado.nO_EMPLE]"><img height="15px" width="15px" class="margen" src="assets\Design\barra-de-puntos.png" alt="">&nbsp;Ver Sugerencias Registradas</a></h6>
                </li>
                </ul>
            </li>
            <li class="menu" *ngIf="!depto">
                <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/buzon-sugerencia', colaboradorSeleccionado.nO_EMPLE]"> <img class="icon" src="assets\Design\buzon.png">&nbsp;Buzón de Sugerencias</a></h6>
            </li>
            <li class="menu" *ngIf="depto">
              <h6><a class="nav-link active menu" aria-current="page" [routerLink]="['/dashboards', colaboradorSeleccionado.nO_EMPLE]"> <img class="icon" src="assets\Design\panel.png">&nbsp;Dashboard Analítica</a></h6>
          </li>
      </ul>
    </div>
<br>
    <div class="formulario">
        <form  [formGroup]="constanciaForm" >
        <h1 style="font-family: 'Merriweather', serif;">Constancias</h1><br>

         <div class="form" *ngIf="colaboradorSeleccionado">
            <label style="font-family: 'Merriweather', serif; font-size: 14px;" class="colaborador">Colaborador:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
            <input class="form-control name" value="{{ colaboradorSeleccionado.nO_EMPLE }} - {{ colaboradorSeleccionado.nombre }}" disabled>
                <br>

                <div>
                  <label style="font-family: 'Merriweather', serif; font-size: 14px;" for="opciones">Tipo de Constancia: &nbsp;</label>
                  <select class="form-select" formControlName="tipo_constancia" id="opciones" [(ngModel)]="opcionSeleccionada" (change)="seleccionarOpcion()" (click)="llamarObtenerConsultaId()">
                    <option *ngFor="let opcion of opciones" [value]="opcion">{{ opcion }}</option>
                  </select>
                </div>
                <br>
                
                <label  style="font-family: 'Merriweather', serif; font-size: 14px;"  for="zonas" class="colaborador">Zona:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                <select class="form-select" formControlName="zona" id="zonas" [(ngModel)]="zonaSeleccionada">
                    <option *ngFor="let opcion of zonas" [value]="opcion">{{ opcion }}</option>
                  </select>
                <br>

                <button [disabled]="constanciaForm.invalid" (click)="mostrarPDF()" class="visualizacion" type="submit" data-bs-toggle="modal" data-bs-target="#miModal" aria-expanded="false">
                  Generar Constancia
              </button>

            </div>
            </form>
            <div class="dirigida" *ngIf="opcionSeleccionada === 'Constancia con Deducciones' || opcionSeleccionada === 'Constancia sin Deducciones'">
              <label style="font-family: 'Merriweather', serif; font-size: 14px;" for="zonas" class="colaborador">Dirigida a:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
              <input class="form-control constancias" [(ngModel)]="dirigidaA">
              <div class="col-auto">
                <span id="passwordHelpInline" class="form-text">
                  *Campo no obligatorio*
                </span>
              </div>
              <br>
            </div> 
    </div>
   
    <div class="modal fade" id="miModal" data-bs-backdrop="static"  tabindex="-1" aria-hidden="true" aria-labelledby="modalTitle">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                 
                <div class="modal-header">
                    <h4>{{opcionSeleccionada}}</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="reload()"></button>
                  </div>
                <div class="modal-body">
                    <ng-container *ngIf="pdfPath">
                        <iframe [src]="pdfPath" width="100%" height="425px"></iframe>
                      </ng-container>          
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
                        Enviar a Correo
                      </button>
                  </div>
                  
            </div>
        </div> 
    </div> 


    <div class="modal fade" id="exampleModal" data-bs-backdrop="static" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
           
                <div class="modal-header">
                    <h4>Envío a Correo Electrónico</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="reload()"></button>
                  </div>
            <div class="modal-body">
                <label for="exampleFormControlInput1" class="form-label correo">Para:</label>
                <input id="destinatarios" [(ngModel)]="destinatarios" name="destinatarios" type="email" class="form-control correo" id="exampleFormControlInput1" placeholder="name@example.com">
                    <br>
                <label for="exampleFormControlInput1" class="form-label correo">Asunto:</label>
                <input id="asunto" [(ngModel)]="asunto"  name="asunto" type="text" class="form-control correo" id="exampleFormControlInput1" placeholder="...">
                <br>
                <div class="mb-3">
                <label for="formFileSm" class="form-label">Constancia Generada:</label>
                <ng-container *ngIf="pdfPath">
                  <iframe  id="archivoAdjunto" name="archivoAdjunto" (change)="onFileSelected($event)" [src]="pdfPath" width="100%" height="250px"></iframe>
                </ng-container>
                </div>
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-primary" (click)="actualizarConstancia('Email')">Enviar</button>
            </div>
           
          </div>
        </div>
      </div>

</body>